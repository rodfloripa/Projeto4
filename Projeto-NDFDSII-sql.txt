/* Slide1- Vendas de músicas de rock por país  */
SELECT
  SUM(Quantity) Total,
  c.Country
FROM Track t
JOIN Genre g
  ON g.GenreId = t.GenreId
JOIN InvoiceLine i
  ON i.TrackId = t.TrackId
JOIN Invoice iv
  ON i.InvoiceId = iv.InvoiceId
JOIN Customer c
  ON c.CustomerId = iv.CustomerId
WHERE g.Name = 'Rock'
GROUP BY 2
ORDER BY 1 DESC
LIMIT 10

/* Slide2- 10 Artistas de Rock que mais faturam  */
SELECT
  ar.Name,
  SUM(i.UnitPrice * i.Quantity) Total
FROM Track t
JOIN Album a
  ON a.AlbumId = t.AlbumId
JOIN Artist ar
  ON ar.ArtistId = a.ArtistId
JOIN Genre g
  ON g.GenreId = t.GenreId
JOIN InvoiceLine i
  ON i.TrackId = t.TrackId
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10

/* Slide3- 5 clientes que mais gastaram  */
SELECT
  c.FirstName||' '|| c.LastName Name,
  inv.CustomerID,
  SUM(i.Quantity * i.UnitPrice)
FROM InvoiceLine i
JOIN Invoice inv
  ON i.InvoiceId = inv.InvoiceId
JOIN Customer c
  ON inv.CustomerId = c.CustomerId
GROUP BY 2
ORDER BY 3 DESC
LIMIT 5

/* Slide4- as 10 músicas mais vendidas  */
SELECT
  t.Name ||'-'|| ar.Name Musica_Artista,
  SUM(i.Quantity) Compras
FROM InvoiceLine i
JOIN Track t
  ON t.TrackId = i.TrackId
JOIN Album a
  ON a.AlbumId = t.AlbumId
JOIN Artist ar
  ON a.ArtistId = ar.ArtistId
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10